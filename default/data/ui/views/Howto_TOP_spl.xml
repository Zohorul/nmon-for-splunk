<form stylesheet="howto.css,ui_simple.css" hideEdit="True">
  <label>HOWTO TOP: Generate stats and charts with Splunk Processing Language (SPL)</label>
  <description>This collection of request samples will help you generating your own reports, dashboards and alerts for Nmon Performance data using the native Splunk Processing Language</description>

  <row>
    <panel>
    
      <html>

		<div class="imgheader">
        <img src="../../static/app/nmon/icons/grey_theme/process.png" alt="Process"/>
        <h2><a href="UI_data_dictionary?form.osfilter=Linux%3Dtrue&amp;form.itemfilter=KERNEL%20STATISTICS&amp;form.itemfilter=PROCESSES%20STATISTICS&amp;form.itemfilter=PAGING%20STATISTICS&amp;form.itemfilter=FIBER%20CHANNEL%20STATISTICS" target="_blank">Process Resources Usage Statistics</a></h2>         
		</div>
      
      <br />
      <br />
      
      </html>
      
   </panel>

    <panel>
    <title>Optionally preset frameID and/or hostname and press Enter:</title>

    <input type="text" token="frameID" searchWhenChanged="true">
      <label>frameID:</label>
      <default>*</default>
    </input>      
    
    <input type="text" token="hostname" searchWhenChanged="true">
      <label>Hostname:</label>
      <default>*</default>
    </input>      
      
   </panel>

  </row>
  
  <row>
    <panel>
    <title>Time oriented and statistics oriented charts:</title>      

	   <html>

		<div>
		  <h2>Time Oriented Charts:</h2>
		  <br />
		</div>		

		<div style="text-align: left;">
		  <br />
		  <img src="../../static/app/nmon/various/mini/minichart.png" alt="minichart"/>
		  <br />
		  <br />
		</div>
				
		<div>
		  <h2>By Server / Program Analysis: Core CPU usage of main processes (consuming more than 0.01 logical core on the host) in multi-series hosts represented by a stacked area chart</h2>			
		  <pre>index=nmon sourcetype=nmon_data type=TOP frameID=* hostname=*guil* Command=*
| bucket _time span=1m
| stats max(pct_CPU) AS pct_CPU, max(logical_cpus) AS logical_cpus by _time,frameID,hostname,Command,PID
| eval limit=(logical_cpus*100) | where (pct_CPU&lt;=limit)
| stats sum(pct_CPU) As pct_CPU, last(logical_cpus) As logical_cpus by _time,hostname,Command
| eval value=(pct_CPU/100)
| where value&gt;0.01
| bucket _time `inline_customspan`
| stats max(value) As value by _time,hostname,Command
| eval s1="value" | makemv s1  | mvexpand s1 | eval yval=case(s1=="value",value)
| eval series=hostname+":"+Command | xyseries _time,series,yval | makecontinuous _time `inline_customspan`</pre>
		</div>		
            
		<div>
				<div class="cat_title">				
				  <a target="_blank" href="search?q=search%20index%3Dnmon%20sourcetype%3Dnmon_data%20type%3DTOP%20frameID%3D*%20hostname%3D*guil*%20Command%3D*%0A%7C%20bucket%20_time%20span%3D1m%0A%7C%20stats%20max(pct_CPU)%20AS%20pct_CPU%2C%20max(logical_cpus)%20AS%20logical_cpus%20by%20_time%2CframeID%2Chostname%2CCommand%2CPID%0A%7C%20eval%20limit%3D(logical_cpus*100)%20%7C%20where%20(pct_CPU&lt;%3Dlimit)%0A%7C%20stats%20sum(pct_CPU)%20As%20pct_CPU%2C%20last(logical_cpus)%20As%20logical_cpus%20by%20_time%2Chostname%2CCommand%0A%7C%20eval%20value%3D(pct_CPU%2F100)%0A%7C%20where%20value&gt;0.01%0A%7C%20bucket%20_time%20%60inline_customspan%60%0A%7C%20stats%20max(value)%20As%20value%20by%20_time%2Chostname%2CCommand%0A%7C%20eval%20s1%3D&quot;value&quot;%20%7C%20makemv%20s1%20%20%7C%20mvexpand%20s1%20%7C%20eval%20yval%3Dcase(s1%3D%3D&quot;value&quot;%2Cvalue)%0A%7C%20eval%20series%3Dhostname%2B&quot;%3A&quot;%2BCommand%20%7C%20xyseries%20_time%2Cseries%2Cyval%20%7C%20makecontinuous%20_time%20%60inline_customspan%60&amp;display.page.search.tab=visualizations&amp;display.general.type=visualizations&amp;display.visualizations.charting.axisY.minimumNumber=0&amp;display.visualizations.charting.chart=area&amp;display.visualizations.charting.axisY.maximumNumber=&amp;display.visualizations.charting.legend.placement=top&amp;earliest=-24h&amp;latest=now&amp;display.visualizations.charting.chart.stackMode=stacked&amp;display.visualizations.charting.axisTitleY.text=Logical%20Core%20CPU%20usage" class="tryitbtn-blue">Open in search »
				  </a>
				</div>
         <br />
		</div>		

		<div>
		  <h2>By Program Analysis: Aggregation of Core CPU usage of main processes (consuming more than 0.01 logical core on the host) by command invocation represented by a stacked area chart</h2>			
		  <pre>index=nmon sourcetype=nmon_data type=TOP frameID=* hostname=*guil* Command=*
| bucket _time span=1m
| stats max(pct_CPU) AS pct_CPU, max(logical_cpus) AS logical_cpus by _time,frameID,hostname,Command,PID
| eval limit=(logical_cpus*100) | where (pct_CPU&lt;=limit)
| stats sum(pct_CPU) As pct_CPU, last(logical_cpus) As logical_cpus by _time,hostname,Command
| eval value=(pct_CPU/100)
| where value&gt;0.01
| bucket _time `inline_customspan`
| stats max(value) As value by _time,hostname,Command
| stats sum(value) AS value by _time,Command
| timechart `inline_customspan` useother=f max(value) AS value by Command</pre>
		</div>		
            
		<div>
				<div class="cat_title">				
				  <a target="_blank" href="search?q=search%20index%3Dnmon%20sourcetype%3Dnmon_data%20type%3DTOP%20frameID%3D*%20hostname%3D*guil*%20Command%3D*%0A%7C%20bucket%20_time%20span%3D1m%0A%7C%20stats%20max(pct_CPU)%20AS%20pct_CPU%2C%20max(logical_cpus)%20AS%20logical_cpus%20by%20_time%2CframeID%2Chostname%2CCommand%2CPID%0A%7C%20eval%20limit%3D(logical_cpus*100)%20%7C%20where%20(pct_CPU&lt;%3Dlimit)%0A%7C%20stats%20sum(pct_CPU)%20As%20pct_CPU%2C%20last(logical_cpus)%20As%20logical_cpus%20by%20_time%2Chostname%2CCommand%0A%7C%20eval%20value%3D(pct_CPU%2F100)%0A%7C%20where%20value&gt;0.01%0A%7C%20bucket%20_time%20%60inline_customspan%60%0A%7C%20stats%20max(value)%20As%20value%20by%20_time%2Chostname%2CCommand%0A%7C%20stats%20sum(value)%20AS%20value%20by%20_time%2CCommand%0A%7C%20timechart%20%60inline_customspan%60%20useother%3Df%20max(value)%20AS%20value%20by%20Command&amp;display.page.search.tab=visualizations&amp;display.general.type=visualizations&amp;display.visualizations.charting.axisY.minimumNumber=0&amp;display.visualizations.charting.chart=area&amp;display.visualizations.charting.axisY.maximumNumber=&amp;display.visualizations.charting.legend.placement=top&amp;earliest=-24h&amp;latest=now&amp;display.visualizations.charting.chart.stackMode=stacked&amp;display.visualizations.charting.axisTitleY.text=Logical%20Core%20CPU%20usage" class="tryitbtn-blue">Open in search »
				  </a>
				</div>
         <br />
		</div>	

		<div>
		  <h2>By Server / Program Analysis with limit serie of available core (will be agregated if multiple hosts are concerned by the search): Core CPU usage of main processes (consuming more than 0.01 logical core on the host) in multi-series hosts represented by a stacked area chart</h2>			
		  <pre>index=nmon sourcetype=nmon_data type=TOP frameID=* hostname=*guil* Command=*
| bucket _time span=1m
| stats max(pct_CPU) AS pct_CPU, max(logical_cpus) AS logical_cpus by _time,frameID,hostname,Command,PID
| eval limit=(logical_cpus*100) | where (pct_CPU&lt;=limit)
| stats sum(pct_CPU) As pct_CPU, last(logical_cpus) As logical_cpus by _time,hostname,Command
| eval value=(pct_CPU/100)
| where value&gt;0.01
| bucket _time `inline_customspan`
| stats max(value) As value by _time,hostname,Command
| stats sum(value) AS value by _time,Command
| timechart `inline_customspan` useother=f max(value) AS value by Command
| appendcols [ search index=nmon sourcetype=nmon_data type=TOP frameID=* hostname=*guil*
| bucket _time span=1m
| stats max(logical_cpus) AS logical_cpus by _time,hostname
| stats sum(logical_cpus) AS logical_cpus by _time
| timechart `inline_customspan` max(logical_cpus) AS logical_cpus ] | fields _time,*,logical_cpus</pre>
		</div>		
            
		<div>
				<div class="cat_title">				
				  <a target="_blank" href="search?q=search%20index%3Dnmon%20sourcetype%3Dnmon_data%20type%3DTOP%20frameID%3D*%20hostname%3D*guil*%20Command%3D*%0A%7C%20bucket%20_time%20span%3D1m%0A%7C%20stats%20max(pct_CPU)%20AS%20pct_CPU%2C%20max(logical_cpus)%20AS%20logical_cpus%20by%20_time%2CframeID%2Chostname%2CCommand%2CPID%0A%7C%20eval%20limit%3D(logical_cpus*100)%20%7C%20where%20(pct_CPU&lt;%3Dlimit)%0A%7C%20stats%20sum(pct_CPU)%20As%20pct_CPU%2C%20last(logical_cpus)%20As%20logical_cpus%20by%20_time%2Chostname%2CCommand%0A%7C%20eval%20value%3D(pct_CPU%2F100)%0A%7C%20where%20value&gt;0.01%0A%7C%20bucket%20_time%20%60inline_customspan%60%0A%7C%20stats%20max(value)%20As%20value%20by%20_time%2Chostname%2CCommand%0A%7C%20stats%20sum(value)%20AS%20value%20by%20_time%2CCommand%0A%7C%20timechart%20%60inline_customspan%60%20useother%3Df%20max(value)%20AS%20value%20by%20Command%0A%7C%20appendcols%20%5B%20search%20index%3Dnmon%20sourcetype%3Dnmon_data%20type%3DTOP%20frameID%3D*%20hostname%3D*guil*%0A%7C%20bucket%20_time%20span%3D1m%0A%7C%20stats%20max(logical_cpus)%20AS%20logical_cpus%20by%20_time%2Chostname%0A%7C%20stats%20sum(logical_cpus)%20AS%20logical_cpus%20by%20_time%0A%7C%20timechart%20%60inline_customspan%60%20max(logical_cpus)%20AS%20logical_cpus%20%5D%20%7C%20fields%20_time%2C*%2Clogical_cpus&amp;display.page.search.tab=visualizations&amp;display.general.type=visualizations&amp;display.visualizations.charting.axisY.minimumNumber=0&amp;display.visualizations.charting.chart=area&amp;display.visualizations.charting.axisY.maximumNumber=&amp;display.visualizations.charting.legend.placement=top&amp;earliest=-24h&amp;latest=now&amp;display.visualizations.charting.chart.stackMode=stacked&amp;display.visualizations.charting.axisTitleY.text=Logical%20Core%20CPU%20usage&amp;display.visualizations.charting.chart.overlayFields=logical_cpus" class="tryitbtn-blue">Open in search »
				  </a>
				</div>
         <br />
		</div>		








		<div>
		  <h2>Stats oriented Charts:</h2>
		  <br />
		</div>

		<div style="text-align: left;">
		  <br />
		  <img src="../../static/app/nmon/various/mini/minisingle.png" alt="minichart"/>
		  <br />
		  <br />
		</div>

		<div>
		  <h2>Single TOP Command Average Logical Core usage over last 24 hours</h2>			
		  <pre>index=nmon sourcetype=nmon_data type=TOP frameID=* hostname=*guil* Command=*
| bucket _time span=1m
| stats max(pct_CPU) AS pct_CPU, max(logical_cpus) AS logical_cpus by _time,frameID,hostname,Command,PID
| eval limit=(logical_cpus*100) | where (pct_CPU&lt;=limit)
| stats sum(pct_CPU) As pct_CPU, last(logical_cpus) As logical_cpus by _time,hostname,Command
| eval value=(pct_CPU/100)
| where value&gt;0.01
| stats avg(value) AS logical_core_usage by hostname,Command
| stats (logical_core_usage) AS logical_core_usage by Command
| sort - logical_core_usage | eval logical_core_usage=round(logical_core_usage, 3) | head 1 | eval stat=Command + " / " + logical_core_usage + " Avg CPU logical core usage" | fields stat</pre>
		</div>		
            
		<div>
				<div class="cat_title">				
				  <a target="_blank" href="search?q=search%20index%3Dnmon%20sourcetype%3Dnmon_data%20type%3DTOP%20frameID%3D*%20hostname%3D*guil*%20Command%3D*%0A%7C%20bucket%20_time%20span%3D1m%0A%7C%20stats%20max(pct_CPU)%20AS%20pct_CPU%2C%20max(logical_cpus)%20AS%20logical_cpus%20by%20_time%2CframeID%2Chostname%2CCommand%2CPID%0A%7C%20eval%20limit%3D(logical_cpus*100)%20%7C%20where%20(pct_CPU&lt;%3Dlimit)%0A%7C%20stats%20sum(pct_CPU)%20As%20pct_CPU%2C%20last(logical_cpus)%20As%20logical_cpus%20by%20_time%2Chostname%2CCommand%0A%7C%20eval%20value%3D(pct_CPU%2F100)%0A%7C%20where%20value&gt;0.01%0A%7C%20stats%20avg(value)%20AS%20logical_core_usage%20by%20hostname%2CCommand%0A%7C%20stats%20sum(logical_core_usage)%20AS%20logical_core_usage%20by%20Command%0A%7C%20sort%20-%20logical_core_usage%20%7C%20eval%20logical_core_usage%3Dround(logical_core_usage%2C%203)%20%7C%20head%201%20%7C%20eval%20stat%3DCommand%20%2B%20&quot;%20%2F%20&quot;%20%2B%20logical_core_usage%20%2B%20&quot;%20Avg%20CPU%20logical%20core%20usage&quot;%20%7C%20fields%20stat&amp;display.page.search.tab=visualizations&amp;display.general.type=visualizations&amp;display.visualizations.charting.axisY.minimumNumber=0&amp;display.visualizations.charting.chart=area&amp;display.visualizations.charting.axisY.maximumNumber=&amp;display.visualizations.charting.legend.placement=top&amp;earliest=-24h&amp;latest=now&amp;display.visualizations.charting.chart.stackMode=stacked&amp;display.visualizations.charting.axisTitleY.text=Logical%20Core%20CPU%20usage&amp;display.visualizations.charting.chart.overlayFields=logical_cpus&amp;display.visualizations.type=singlevalue&amp;display.visualizations.singlevalue.underLabel=TOP%20COMMAND%20AVERAGE%20LOGICAL%20CORE%20CPU%20USAGE" class="tryitbtn-blue">Open in search »
				  </a>
				</div>
         <br />
		</div>

		<div>
		  <h2>Single TOP Command Max Logical Core usage over last 24 hours</h2>			
		  <pre>index=nmon sourcetype=nmon_data type=TOP frameID=* hostname=*guil* Command=*
| bucket _time span=1m
| stats max(pct_CPU) AS pct_CPU, max(logical_cpus) AS logical_cpus by _time,frameID,hostname,Command,PID
| eval limit=(logical_cpus*100) | where (pct_CPU&lt;=limit)
| stats sum(pct_CPU) As pct_CPU, last(logical_cpus) As logical_cpus by _time,hostname,Command
| eval value=(pct_CPU/100)
| where value>0.01
| stats max(value) AS logical_core_usage by hostname,Command
| stats sum(logical_core_usage) AS logical_core_usage by Command
| sort - logical_core_usage | eval logical_core_usage=round(logical_core_usage, 3) | head 1 | eval stat=Command + " / " + logical_core_usage + " Max CPU logical core usage" | fields stat</pre>
		</div>		
            
		<div>
				<div class="cat_title">				
				  <a target="_blank" href="search?q=search%20index%3Dnmon%20sourcetype%3Dnmon_data%20type%3DTOP%20frameID%3D*%20hostname%3D*guil*%20Command%3D*%0A%7C%20bucket%20_time%20span%3D1m%0A%7C%20stats%20max(pct_CPU)%20AS%20pct_CPU%2C%20max(logical_cpus)%20AS%20logical_cpus%20by%20_time%2CframeID%2Chostname%2CCommand%2CPID%0A%7C%20eval%20limit%3D(logical_cpus*100)%20%7C%20where%20(pct_CPU&lt;%3Dlimit)%0A%7C%20stats%20sum(pct_CPU)%20As%20pct_CPU%2C%20last(logical_cpus)%20As%20logical_cpus%20by%20_time%2Chostname%2CCommand%0A%7C%20eval%20value%3D(pct_CPU%2F100)%0A%7C%20where%20value&gt;0.01%0A%7C%20stats%20max(value)%20AS%20logical_core_usage%20by%20hostname%2CCommand%0A%7C%20stats%20sum(logical_core_usage)%20AS%20logical_core_usage%20by%20Command%0A%7C%20sort%20-%20logical_core_usage%20%7C%20eval%20logical_core_usage%3Dround(logical_core_usage%2C%203)%20%7C%20head%201%20%7C%20eval%20stat%3DCommand%20%2B%20&quot;%20%2F%20&quot;%20%2B%20logical_core_usage%20%2B%20&quot;%20Max%20CPU%20logical%20core%20usage&quot;%20%7C%20fields%20stat&amp;display.page.search.tab=visualizations&amp;display.general.type=visualizations&amp;display.visualizations.charting.axisY.minimumNumber=0&amp;display.visualizations.charting.chart=area&amp;display.visualizations.charting.axisY.maximumNumber=&amp;display.visualizations.charting.legend.placement=top&amp;earliest=-24h&amp;latest=now&amp;display.visualizations.charting.chart.stackMode=stacked&amp;display.visualizations.charting.axisTitleY.text=Logical%20Core%20CPU%20usage&amp;display.visualizations.charting.chart.overlayFields=logical_cpus&amp;display.visualizations.type=singlevalue&amp;display.visualizations.singlevalue.underLabel=TOP%20COMMAND%20MAX%20LOGICAL%20CORE%20CPU%20USAGE" class="tryitbtn-blue">Open in search »
				  </a>
				</div>
         <br />
		</div>


		<div style="text-align: left;">
		  <img src="../../static/app/nmon/various/mini/minicolumn.png" alt="minicolumn"/>
		  <br />
		  <br />
		</div>

		<div>
		  <h2>Column chart of TOP 10 average CPU Usage in Percentage over last 24 hours</h2>			
		  <pre>index=nmon sourcetype=nmon_data type=CPU_ALL frameID=$frameID$ hostname=$hostname$ | eval cpu_PCT=round((Sys_PCT+User_PCT+Wait_PCT),2)
| stats avg(cpu_PCT) AS cpu_PCT by hostname | sort - cpu_PCT | head 10
| eval xlabel=""
| chart useother=f limit=0 values(cpu_PCT) AS "Avg CPU %" by xlabel,hostname | rename xlabel AS "TOP 10 CPU % usage"</pre>
		</div>		
            
		<div>
				<div class="cat_title">				
				  <a target="_blank" href="search?q=search%20index%3Dnmon%20sourcetype%3Dnmon_data%20type%3DCPU_ALL%20frameID%3D$frameID$%20hostname%3D$hostname$%20%7C%20eval%20cpu_PCT%3Dround((Sys_PCT%2BUser_PCT%2BWait_PCT)%2C2)%0A%7C%20stats%20avg(cpu_PCT)%20AS%20cpu_PCT%20by%20hostname%20%7C%20sort%20-%20cpu_PCT%20%7C%20head%2010%0A%7C%20eval%20xlabel%3D&quot;&quot;%0A%7C%20chart%20useother%3Df%20limit%3D0%20values(cpu_PCT)%20AS%20&quot;Avg%20CPU%20%25&quot;%20by%20xlabel%2Chostname%20%7C%20rename%20xlabel%20AS%20&quot;TOP%2010%20CPU%20%25%20usage&quot;&amp;earliest=%40y&amp;latest=now&amp;display.page.search.tab=visualizations&amp;display.general.type=visualizations&amp;display.visualizations.charting.chart=column&amp;display.visualizations.charting.legend.placement=top&amp;display.visualizations.charting.axisY.minimumNumber=0&amp;display.visualizations.charting.axisY.maximumNumber=100" class="tryitbtn-blue">Open in search »
				  </a>
				</div>
         <br />
		</div>

    </html>
    
    </panel>
  </row>

  <row>
    <panel>
    <title>Table Statistics:</title>      

	   <html>

		<div style="text-align: left;">
		  <br />
		  <img src="../../static/app/nmon/various/mini/minitable.png" alt="minitable"/>
		  <br />
		  <br />
		</div>

		<div>
		  <h2>Min / Average / Max CPU Usage in Percentage over last 24 hours ordered and sorted by frame ID, hostnames</h2>			
		  <pre>index=nmon sourcetype=nmon_data type=CPU_ALL frameID=$frameID$ hostname=$hostname$ | eval cpu_PCT=round((Sys_PCT+User_PCT+Wait_PCT),2) 
| stats min(cpu_PCT) AS "Min % CPU usage", avg(cpu_PCT) AS "Avg % CPU usage", max(cpu_PCT) AS "Max % CPU usage" by frameID,hostname | eval "Avg % CPU usage"=round('Avg % CPU usage', 2) | sort frameID,hostname</pre>
		</div>		
            
		<div>
				<div class="cat_title">				
				  <a target="_blank" href="search?q=search%20index%3Dnmon%20sourcetype%3Dnmon_data%20type%3DCPU_ALL%20frameID%3D$frameID$%20hostname%3D$hostname$%20%7C%20eval%20cpu_PCT%3Dround((Sys_PCT%2BUser_PCT%2BWait_PCT)%2C2)%20%0A%7C%20stats%20min(cpu_PCT)%20AS%20&quot;Min%20%25%20CPU%20usage&quot;%2C%20avg(cpu_PCT)%20AS%20&quot;Avg%20%25%20CPU%20usage&quot;%2C%20max(cpu_PCT)%20AS%20&quot;Max%20%25%20CPU%20usage&quot;%20by%20frameID%2Chostname%20%7C%20eval%20&quot;Avg%20%25%20CPU%20usage&quot;%3Dround(%27Avg%20%25%20CPU%20usage%27%2C%202)%20%7C%20sort%20frameID%2Chostname&amp;display.page.search.tab=statistics&amp;display.general.type=statistics&amp;earliest=-24h&amp;latest=now" class="tryitbtn-blue">Open in search »
				  </a>
				</div>
         <br />
		</div>		

		<div>
		  <h2>Min / Average / Max and Average sparkline of CPU Usage in Percentage over last 24 hours ordered and sorted by frame ID, hostnames</h2>			
		  <pre>index=nmon sourcetype=nmon_data type=CPU_ALL frameID=$frameID$ hostname=$hostname$ | eval cpu_PCT=round((Sys_PCT+User_PCT+Wait_PCT),2) 
| stats min(cpu_PCT) AS "Min % CPU usage", avg(cpu_PCT) AS "Avg % CPU usage", max(cpu_PCT) AS "Max % CPU usage" by frameID,hostname | eval "Avg % CPU usage"=round('Avg % CPU usage', 2) | sort frameID,hostname</pre>
		</div>		
            
		<div>
				<div class="cat_title">				
				  <a target="_blank" href="search?q=search%20index%3Dnmon%20sourcetype%3Dnmon_data%20type%3DCPU_ALL%20frameID%3D$frameID$%20hostname%3D$hostname$%20%7C%20eval%20cpu_PCT%3Dround((Sys_PCT%2BUser_PCT%2BWait_PCT)%2C2)%20%0A%7C%20stats%20min(cpu_PCT)%20AS%20&quot;Min%20%25%20CPU%20usage&quot;%2C%20avg(cpu_PCT)%20AS%20&quot;Avg%20%25%20CPU%20usage&quot;%2C%20max(cpu_PCT)%20AS%20&quot;Max%20%25%20CPU%20usage&quot;%2C%20sparkline(avg(cpu_PCT))%20As%20sparkline%20by%20frameID%2Chostname%20%7C%20eval%20&quot;Avg%20%25%20CPU%20usage&quot;%3Dround(%27Avg%20%25%20CPU%20usage%27%2C%202)%20%7C%20sort%20frameID%2Chostname&amp;display.page.search.tab=statistics&amp;display.general.type=statistics&amp;earliest=-24h&amp;latest=now" class="tryitbtn-blue">Open in search »
				  </a>
				</div>
         <br />
		</div>		

		<div>
		  <h2>Min / Average / Max of CPU Usage in Percentage over last 30 days for Business days only (monday to friday, 24hrs / 24hrs) ordered and sorted by frame ID, hostnames</h2>			
		  <pre>index=nmon sourcetype=nmon_data type=CPU_ALL frameID=$frameID$ hostname=$hostname$ | eval cpu_PCT=round((Sys_PCT+User_PCT+Wait_PCT),2)
| eval date_wday=lower(strftime('_time', "%A")) | search (date_wday!="sunday" date_wday!="saturday") 
| stats min(cpu_PCT) AS "Min % CPU usage", avg(cpu_PCT) AS "Avg % CPU usage", max(cpu_PCT) AS "Max % CPU usage" by frameID,hostname | eval "Avg % CPU usage"=round('Avg % CPU usage', 2) | sort frameID,hostname</pre>
		</div>		
            
		<div>
				<div class="cat_title">				
				  <a target="_blank" href="search?q=search%20index%3Dnmon%20sourcetype%3Dnmon_data%20type%3DCPU_ALL%20frameID%3D$frameID$%20hostname%3D$hostname$%20%7C%20eval%20cpu_PCT%3Dround((Sys_PCT%2BUser_PCT%2BWait_PCT)%2C2)%0A%7C%20eval%20date_wday%3Dlower(strftime(%27_time%27%2C%20&quot;%25A&quot;))%20%7C%20search%20(date_wday!%3D&quot;sunday&quot;%20date_wday!%3D&quot;saturday&quot;)%20%0A%7C%20stats%20min(cpu_PCT)%20AS%20&quot;Min%20%25%20CPU%20usage&quot;%2C%20avg(cpu_PCT)%20AS%20&quot;Avg%20%25%20CPU%20usage&quot;%2C%20max(cpu_PCT)%20AS%20&quot;Max%20%25%20CPU%20usage&quot;%20by%20frameID%2Chostname%20%7C%20eval%20&quot;Avg%20%25%20CPU%20usage&quot;%3Dround(%27Avg%20%25%20CPU%20usage%27%2C%202)%20%7C%20sort%20frameID%2Chostname&amp;display.page.search.tab=statistics&amp;display.general.type=statistics&amp;earliest=-30d%40d&amp;latest=now" class="tryitbtn-blue">Open in search »
				  </a>
				</div>
         <br />
		</div>		

		<div>
		  <h2>Min / Average / Max of CPU Usage in Percentage over last 30 days for Working hours Business days only (monday to friday, 08h to 19h) ordered and sorted by frame ID, hostnames</h2>			
		  <pre>index=nmon sourcetype=nmon_data type=CPU_ALL frameID=$frameID$ hostname=$hostname$ | eval cpu_PCT=round((Sys_PCT+User_PCT+Wait_PCT),2)
| eval date_wday=lower(strftime('_time', "%A")) | eval local_time=strftime('_time', "%H%M")
| search (date_wday!="sunday" date_wday!="saturday") AND (local_time&gt;="0800" AND local_time&lt;="1900")
| stats min(cpu_PCT) AS "Min % CPU usage", avg(cpu_PCT) AS "Avg % CPU usage", max(cpu_PCT) AS "Max % CPU usage" by frameID,hostname | eval "Avg % CPU usage"=round('Avg % CPU usage', 2) | sort frameID,hostname</pre>
		</div>		
            
		<div>
				<div class="cat_title">				
				  <a target="_blank" href="search?q=search%20index%3Dnmon%20sourcetype%3Dnmon_data%20type%3DCPU_ALL%20frameID%3D$frameID$%20hostname%3D$hostname$%20%7C%20eval%20cpu_PCT%3Dround((Sys_PCT%2BUser_PCT%2BWait_PCT)%2C2)%0A%7C%20eval%20date_wday%3Dlower(strftime(%27_time%27%2C%20&quot;%25A&quot;))%20%7C%20eval%20local_time%3Dstrftime(%27_time%27%2C%20&quot;%25H%25M&quot;)%0A%7C%20search%20(date_wday!%3D&quot;sunday&quot;%20date_wday!%3D&quot;saturday&quot;)%20AND%20(local_time&gt;%3D&quot;0800&quot;%20AND%20local_time&lt;%3D&quot;1900&quot;)%0A%7C%20stats%20min(cpu_PCT)%20AS%20&quot;Min%20%25%20CPU%20usage&quot;%2C%20avg(cpu_PCT)%20AS%20&quot;Avg%20%25%20CPU%20usage&quot;%2C%20max(cpu_PCT)%20AS%20&quot;Max%20%25%20CPU%20usage&quot;%20by%20frameID%2Chostname%20%7C%20eval%20&quot;Avg%20%25%20CPU%20usage&quot;%3Dround(%27Avg%20%25%20CPU%20usage%27%2C%202)%20%7C%20sort%20frameID%2Chostname&amp;display.page.search.tab=statistics&amp;display.general.type=statistics&amp;earliest=-30d%40d&amp;latest=now" class="tryitbtn-blue">Open in search »
				  </a>
				</div>
         <br />
		</div>		

		<div>
		  <h2>Min / Average / Max of CPU Usage in Percentage over last 30 days for non Working hours Business days only (monday to friday, 19h to 08h) ordered and sorted by frame ID, hostnames</h2>			
		  <pre>index=nmon sourcetype=nmon_data type=CPU_ALL frameID=$frameID$ hostname=$hostname$ | eval cpu_PCT=round((Sys_PCT+User_PCT+Wait_PCT),2)
| eval date_wday=lower(strftime('_time', "%A")) | eval local_time=strftime('_time', "%H%M")
| search (local_time&gt;="1900" AND local_time&lt;="2359") OR (local_time&gt;="0000" AND local_time&lt;="0800") AND (date_wday!="sunday" date_wday!="saturday")
| stats min(cpu_PCT) AS "Min % CPU usage", avg(cpu_PCT) AS "Avg % CPU usage", max(cpu_PCT) AS "Max % CPU usage" by frameID,hostname | eval "Avg % CPU usage"=round('Avg % CPU usage', 2) | sort frameID,hostname</pre>
		</div>		
            
		<div>
				<div class="cat_title">				
				  <a target="_blank" href="search?q=search%20index%3Dnmon%20sourcetype%3Dnmon_data%20type%3DCPU_ALL%20frameID%3D$frameID$%20hostname%3D$hostname$%20%7C%20eval%20cpu_PCT%3Dround((Sys_PCT%2BUser_PCT%2BWait_PCT)%2C2)%0A%7C%20eval%20date_wday%3Dlower(strftime(%27_time%27%2C%20&quot;%25A&quot;))%20%7C%20eval%20local_time%3Dstrftime(%27_time%27%2C%20&quot;%25H%25M&quot;)%0A%7C%20search%20(local_time&gt;%3D&quot;1900&quot;%20AND%20local_time&lt;%3D&quot;2359&quot;)%20OR%20(local_time&gt;%3D&quot;0000&quot;%20AND%20local_time&lt;%3D&quot;0800&quot;)%20AND%20(date_wday!%3D&quot;sunday&quot;%20date_wday!%3D&quot;saturday&quot;)%0A%7C%20stats%20min(cpu_PCT)%20AS%20&quot;Min%20%25%20CPU%20usage&quot;%2C%20avg(cpu_PCT)%20AS%20&quot;Avg%20%25%20CPU%20usage&quot;%2C%20max(cpu_PCT)%20AS%20&quot;Max%20%25%20CPU%20usage&quot;%20by%20frameID%2Chostname%20%7C%20eval%20&quot;Avg%20%25%20CPU%20usage&quot;%3Dround(%27Avg%20%25%20CPU%20usage%27%2C%202)%20%7C%20sort%20frameID%2Chostname&amp;display.page.search.tab=statistics&amp;display.general.type=statistics&amp;earliest=-30d%40d&amp;latest=now" class="tryitbtn-blue">Open in search »
				  </a>
				</div>
         <br />
		</div>		

		<div>
		  <h2>Compare Average CPU Usage in Percentage of current month versus previous month ordered and sorted by hostnames</h2>			
		  <pre>index="nmon" sourcetype="nmon_data" hostname="*" type=CPU_ALL earliest="-1mon@mon" latest="@mon" | eval usage=(Sys_PCT+User_PCT+Wait_PCT)
| stats avg(usage) As usage_period1 by hostname
| append [ 
search index="nmon" sourcetype="nmon_data" hostname="*" type=CPU_ALL earliest="@mon" latest="now" | eval usage=(Sys_PCT+User_PCT+Wait_PCT)
| stats avg(usage) As usage_period2 by hostname ] | stats values(*) AS * by hostname
| `eval_compare`</pre>
		</div>		
            
		<div>
				<div class="cat_title">				
				  <a target="_blank" href="search?q=search%20index%3D&quot;nmon&quot;%20sourcetype%3D&quot;nmon_data&quot;%20hostname%3D&quot;*&quot;%20type%3DCPU_ALL%20earliest%3D&quot;-1mon%40mon&quot;%20latest%3D&quot;%40mon&quot;%20%7C%20eval%20usage%3D(Sys_PCT%2BUser_PCT%2BWait_PCT)%0A%7C%20stats%20avg(usage)%20As%20usage_period1%20by%20hostname%0A%7C%20append%20%5B%20%0Asearch%20index%3D&quot;nmon&quot;%20sourcetype%3D&quot;nmon_data&quot;%20hostname%3D&quot;*&quot;%20type%3DCPU_ALL%20earliest%3D&quot;%40mon&quot;%20latest%3D&quot;now&quot;%20%7C%20eval%20usage%3D(Sys_PCT%2BUser_PCT%2BWait_PCT)%0A%7C%20stats%20avg(usage)%20As%20usage_period2%20by%20hostname%20%5D%20%7C%20stats%20values(*)%20AS%20*%20by%20hostname%0A%7C%20%60eval_compare%60&amp;display.page.search.tab=statistics&amp;display.general.type=statistics" class="tryitbtn-blue">Open in search »
				  </a>
				</div>
         <br />
		</div>		

     </html>

    </panel>
  </row>

  <row>
    <panel>
    <title>Alerting:</title>      

	   <html>

		<div style="text-align: left;">
		  <br />
		  <img src="../../static/app/nmon/various/mini/minisingle.png" alt="minisingle"/>
		  <br />
		  <br />
		</div>

		<div>
		  <h2>Use transaction to find servers having an average CPU usage higher than 90% for a minimal contiguous period of 5 minutes</h2>			
		  <pre>index=nmon sourcetype=nmon_data type=CPU_ALL frameID=$frameID$ hostname=$hostname$
| eval cpu_PCT=round((Sys_PCT+User_PCT+Wait_PCT),2)
| where cpu_PCT>90
| transaction hostname cpu_PCT maxpause=5m | where duration&gt;300
| fields _time,frameID,hostname,duration,cpu_PCT,Sys_PCT,User_PCT,Wait_PCT,Idle_PCT | stats values(*) AS * by _time,hostname
| eval "duration (hh:mm:ss)"=tostring(duration,"duration") | rename duration AS "duration (seconds)"
| fields _time,frameID,hostname,duration*,cpu_PCT,Sys_PCT,User_PCT,Wait_PCT,Idle_PCT</pre>
		</div>		
            
		<div>
				<div class="cat_title">				
				  <a target="_blank" href="search?q=search%20index%3Dnmon%20sourcetype%3Dnmon_data%20type%3DCPU_ALL%20frameID%3D$frameID$%20hostname%3D$hostname$%0A%7C%20eval%20cpu_PCT%3Dround((Sys_PCT%2BUser_PCT%2BWait_PCT)%2C2)%0A%7C%20where%20cpu_PCT&gt;90%0A%7C%20transaction%20hostname%20cpu_PCT%20maxpause%3D5m%20%7C%20where%20duration&gt;300%0A%7C%20fields%20_time%2CframeID%2Chostname%2Cduration%2Ccpu_PCT%2CSys_PCT%2CUser_PCT%2CWait_PCT%2CIdle_PCT%20%7C%20stats%20values(*)%20AS%20*%20by%20_time%2Chostname%0A%7C%20eval%20&quot;duration%20(hh%3Amm%3Ass)&quot;%3Dtostring(duration%2C&quot;duration&quot;)%20%7C%20rename%20duration%20AS%20&quot;duration%20(seconds)&quot;%0A%7C%20fields%20_time%2CframeID%2Chostname%2Cduration*%2Ccpu_PCT%2CSys_PCT%2CUser_PCT%2CWait_PCT%2CIdle_PCT&amp;display.page.search.tab=statistics&amp;display.general.type=statistics&amp;earliest=-24h&amp;latest=now" class="tryitbtn-blue">Open in search »
				  </a>
				</div>
         <br />
		</div>		

		<div>
		  <h2>Use transaction to find servers having an average CPU usage higher than 90% for a minimal contiguous period of 5 minutes, restricted to Open hours and Business days (monday to friday, 08h to 19h)</h2>			
		  <pre>index=nmon sourcetype=nmon_data type=CPU_ALL frameID=$frameID$ hostname=$hostname$
| eval cpu_PCT=round((Sys_PCT+User_PCT+Wait_PCT),2)
| eval date_wday=lower(strftime('_time', "%A")) | eval local_time=strftime('_time', "%H%M")
| search (date_wday!="sunday" date_wday!="saturday") AND (local_time&gt;="0800" AND local_time&lt;="1900")
| where cpu_PCT>90
| transaction hostname cpu_PCT maxpause=5m | where duration&gt;300
| fields _time,frameID,hostname,duration,cpu_PCT,Sys_PCT,User_PCT,Wait_PCT,Idle_PCT | stats values(*) AS * by _time,hostname
| eval "duration (hh:mm:ss)"=tostring(duration,"duration") | rename duration AS "duration (seconds)"
| fields _time,frameID,hostname,duration*,cpu_PCT,Sys_PCT,User_PCT,Wait_PCT,Idle_PCT</pre>
		</div>		
            
		<div>
				<div class="cat_title">				
				  <a target="_blank" href="search?q=search%20index%3Dnmon%20sourcetype%3Dnmon_data%20type%3DCPU_ALL%20frameID%3D$frameID$%20hostname%3D$hostname$%0A%7C%20eval%20cpu_PCT%3Dround((Sys_PCT%2BUser_PCT%2BWait_PCT)%2C2)%0A%7C%20eval%20date_wday%3Dlower(strftime(%27_time%27%2C%20&quot;%25A&quot;))%20%7C%20eval%20local_time%3Dstrftime(%27_time%27%2C%20&quot;%25H%25M&quot;)%0A%7C%20search%20(date_wday!%3D&quot;sunday&quot;%20date_wday!%3D&quot;saturday&quot;)%20AND%20(local_time&gt;%3D&quot;0800&quot;%20AND%20local_time&lt;%3D&quot;1900&quot;)%0A%7C%20where%20cpu_PCT&gt;90%0A%7C%20transaction%20hostname%20cpu_PCT%20maxpause%3D5m%20%7C%20where%20duration&gt;300%0A%7C%20fields%20_time%2CframeID%2Chostname%2Cduration%2Ccpu_PCT%2CSys_PCT%2CUser_PCT%2CWait_PCT%2CIdle_PCT%20%7C%20stats%20values(*)%20AS%20*%20by%20_time%2Chostname%0A%7C%20eval%20&quot;duration%20(hh%3Amm%3Ass)&quot;%3Dtostring(duration%2C&quot;duration&quot;)%20%7C%20rename%20duration%20AS%20&quot;duration%20(seconds)&quot;%0A%7C%20fields%20_time%2CframeID%2Chostname%2Cduration*%2Ccpu_PCT%2CSys_PCT%2CUser_PCT%2CWait_PCT%2CIdle_PCT&amp;display.page.search.tab=statistics&amp;display.general.type=statistics&amp;earliest=-24h&amp;latest=now" class="tryitbtn-blue">Open in search »
				  </a>
				</div>
         <br />
		</div>		
		
	  </html>

	</panel>
	
  </row>	

</form>